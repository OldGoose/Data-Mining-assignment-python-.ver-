{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Kidney Analysis\n",
    "\n",
    "The data was taken over a 2-month period in India with 25 features ( eg, red blood cell count, white blood cell count, etc). The target is the 'classification', which is either 'ckd' or 'notckd' - ckd=chronic kidney disease. There are 400 rows\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.輸入package"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "        <script type=\"text/javascript\">\n",
       "        window.PlotlyConfig = {MathJaxConfig: 'local'};\n",
       "        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n",
       "        if (typeof require !== 'undefined') {\n",
       "        require.undef(\"plotly\");\n",
       "        requirejs.config({\n",
       "            paths: {\n",
       "                'plotly': ['https://cdn.plot.ly/plotly-latest.min']\n",
       "            }\n",
       "        });\n",
       "        require(['plotly'], function(Plotly) {\n",
       "            window._Plotly = Plotly;\n",
       "        });\n",
       "        }\n",
       "        </script>\n",
       "        "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Basic package\n",
    "import numpy as np \n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns #for confusion matrix\n",
    "from fancyimpute import KNN, NuclearNormMinimization, SoftImpute, IterativeImputer, BiScaler\n",
    "import seaborn as sns\n",
    "import nltk\n",
    "from nltk.corpus import stopwords\n",
    "import time\n",
    "import spacy\n",
    "from scipy.misc import imread\n",
    "from sklearn.utils import resample\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.metrics import accuracy_score\n",
    "from matplotlib import pyplot\n",
    "#For data visualization\n",
    "import plotly.plotly as py\n",
    "from plotly.offline import init_notebook_mode, iplot\n",
    "init_notebook_mode(connected=True)\n",
    "import plotly.graph_objs as go"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.Import Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "data=pd.read_csv(\"/home/oldgoose/下載/kidney_disease.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.資料預處理"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 400 entries, 0 to 399\n",
      "Data columns (total 26 columns):\n",
      "id                400 non-null int64\n",
      "age               391 non-null float64\n",
      "bp                388 non-null float64\n",
      "sg                353 non-null float64\n",
      "al                354 non-null float64\n",
      "su                351 non-null float64\n",
      "rbc               248 non-null object\n",
      "pc                335 non-null object\n",
      "pcc               396 non-null object\n",
      "ba                396 non-null object\n",
      "bgr               356 non-null float64\n",
      "bu                381 non-null float64\n",
      "sc                383 non-null float64\n",
      "sod               313 non-null float64\n",
      "pot               312 non-null float64\n",
      "hemo              348 non-null float64\n",
      "pcv               330 non-null object\n",
      "wc                295 non-null object\n",
      "rc                270 non-null object\n",
      "htn               398 non-null object\n",
      "dm                398 non-null object\n",
      "cad               398 non-null object\n",
      "appet             399 non-null object\n",
      "pe                399 non-null object\n",
      "ane               399 non-null object\n",
      "classification    400 non-null object\n",
      "dtypes: float64(11), int64(1), object(14)\n",
      "memory usage: 81.3+ KB\n"
     ]
    }
   ],
   "source": [
    "#觀察資料樣貌\n",
    "data.info()\n",
    "#砍掉ID欄位\n",
    "data.drop(\"id\",axis=1,inplace=True) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3-1.觀察object 欄位的內容"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "rbc unique values: [nan 'normal' 'abnormal']\n",
      "********************\n",
      "pc unique values: ['normal' 'abnormal' nan]\n",
      "********************\n",
      "pcc unique values: ['notpresent' 'present' nan]\n",
      "********************\n",
      "ba unique values: ['notpresent' 'present' nan]\n",
      "********************\n",
      "pcv unique values: ['44' '38' '31' '32' '35' '39' '36' '33' '29' '28' nan '16' '24' '37' '30'\n",
      " '34' '40' '45' '27' '48' '\\t?' '52' '14' '22' '18' '42' '17' '46' '23'\n",
      " '19' '25' '41' '26' '15' '21' '43' '20' '\\t43' '47' '9' '49' '50' '53'\n",
      " '51' '54']\n",
      "********************\n",
      "wc unique values: ['7800' '6000' '7500' '6700' '7300' nan '6900' '9600' '12100' '4500'\n",
      " '12200' '11000' '3800' '11400' '5300' '9200' '6200' '8300' '8400' '10300'\n",
      " '9800' '9100' '7900' '6400' '8600' '18900' '21600' '4300' '8500' '11300'\n",
      " '7200' '7700' '14600' '6300' '\\t6200' '7100' '11800' '9400' '5500' '5800'\n",
      " '13200' '12500' '5600' '7000' '11900' '10400' '10700' '12700' '6800'\n",
      " '6500' '13600' '10200' '9000' '14900' '8200' '15200' '5000' '16300'\n",
      " '12400' '\\t8400' '10500' '4200' '4700' '10900' '8100' '9500' '2200'\n",
      " '12800' '11200' '19100' '\\t?' '12300' '16700' '2600' '26400' '8800'\n",
      " '7400' '4900' '8000' '12000' '15700' '4100' '5700' '11500' '5400' '10800'\n",
      " '9900' '5200' '5900' '9300' '9700' '5100' '6600']\n",
      "********************\n",
      "rc unique values: ['5.2' nan '3.9' '4.6' '4.4' '5' '4.0' '3.7' '3.8' '3.4' '2.6' '2.8' '4.3'\n",
      " '3.2' '3.6' '4' '4.1' '4.9' '2.5' '4.2' '4.5' '3.1' '4.7' '3.5' '6.0'\n",
      " '5.0' '2.1' '5.6' '2.3' '2.9' '2.7' '8.0' '3.3' '3.0' '3' '2.4' '4.8'\n",
      " '\\t?' '5.4' '6.1' '6.2' '6.3' '5.1' '5.8' '5.5' '5.3' '6.4' '5.7' '5.9'\n",
      " '6.5']\n",
      "********************\n",
      "htn unique values: ['yes' 'no' nan]\n",
      "********************\n",
      "dm unique values: ['yes' 'no' ' yes' '\\tno' '\\tyes' nan]\n",
      "********************\n",
      "cad unique values: ['no' 'yes' '\\tno' nan]\n",
      "********************\n",
      "appet unique values: ['good' 'poor' nan]\n",
      "********************\n",
      "pe unique values: ['no' 'yes' nan]\n",
      "********************\n",
      "ane unique values: ['no' 'yes' nan]\n",
      "********************\n",
      "classification unique values: ['ckd' 'ckd\\t' 'notckd']\n",
      "********************\n"
     ]
    }
   ],
   "source": [
    "dtype_object=data.select_dtypes(include=['object'])\n",
    "dtype_object.head()\n",
    "for x in dtype_object.columns:\n",
    "    print(\"{} unique values:\".format(x),data[x].unique())\n",
    "    print(\"*\"*20)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3-2.將有問題的欄位取代為正確值，並將object 轉換為0,1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "df=data\n",
    "df[['htn','dm','cad','pe','ane']] = df[['htn','dm','cad','pe','ane']].replace(to_replace={'yes':1,'no':0})\n",
    "df[['rbc','pc']] = df[['rbc','pc']].replace(to_replace={'abnormal':1,'normal':0})\n",
    "df[['pcc','ba']] = df[['pcc','ba']].replace(to_replace={'present':1,'notpresent':0})\n",
    "df[['appet']] = df[['appet']].replace(to_replace={'good':1,'poor':0,'no':np.nan})\n",
    "df['classification'] = df['classification'].replace(to_replace={'ckd':1.0,'ckd\\t':1.0,'notckd':0.0,'no':0.0})\n",
    "df['pe'] = df['pe'].replace(to_replace='good',value=0) # Not having pedal edema is good\n",
    "df['appet'] = df['appet'].replace(to_replace='no',value=0)\n",
    "df['cad'] = df['cad'].replace(to_replace='\\tno',value=0)\n",
    "df['dm'] = df['dm'].replace(to_replace={'\\tno':0,'\\tyes':1,' yes':1, '':np.nan})\n",
    "\n",
    "#將'rc','wc','pcv'轉換為float\n",
    "from sklearn.model_selection import train_test_split\n",
    "for i in ['rc','wc','pcv']:\n",
    "    df[i] = df[i].str.extract('(\\d+)').astype(float)\n",
    "    \n",
    "#將dm,class轉換為float\n",
    "df['dm'] = df['dm'].astype('float')\n",
    "df['classification'] = df['classification'].astype('float')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 400 entries, 0 to 399\n",
      "Data columns (total 25 columns):\n",
      "age               391 non-null float64\n",
      "bp                388 non-null float64\n",
      "sg                353 non-null float64\n",
      "al                354 non-null float64\n",
      "su                351 non-null float64\n",
      "rbc               248 non-null float64\n",
      "pc                335 non-null float64\n",
      "pcc               396 non-null float64\n",
      "ba                396 non-null float64\n",
      "bgr               356 non-null float64\n",
      "bu                381 non-null float64\n",
      "sc                383 non-null float64\n",
      "sod               313 non-null float64\n",
      "pot               312 non-null float64\n",
      "hemo              348 non-null float64\n",
      "pcv               329 non-null float64\n",
      "wc                294 non-null float64\n",
      "rc                269 non-null float64\n",
      "htn               398 non-null float64\n",
      "dm                398 non-null float64\n",
      "cad               398 non-null float64\n",
      "appet             399 non-null float64\n",
      "pe                399 non-null float64\n",
      "ane               399 non-null float64\n",
      "classification    400 non-null float64\n",
      "dtypes: float64(25)\n",
      "memory usage: 78.2 KB\n"
     ]
    }
   ],
   "source": [
    "#確認資料結構統一化\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3-3.遺漏值處理"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "age                 9\n",
       "bp                 12\n",
       "sg                 47\n",
       "al                 46\n",
       "su                 49\n",
       "rbc               152\n",
       "pc                 65\n",
       "pcc                 4\n",
       "ba                  4\n",
       "bgr                44\n",
       "bu                 19\n",
       "sc                 17\n",
       "sod                87\n",
       "pot                88\n",
       "hemo               52\n",
       "pcv                71\n",
       "wc                106\n",
       "rc                131\n",
       "htn                 2\n",
       "dm                  2\n",
       "cad                 2\n",
       "appet               1\n",
       "pe                  1\n",
       "ane                 1\n",
       "classification      0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#統計各欄位遺漏值數量\n",
    "df.isnull().sum() "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 方法一 KNN 填補"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Imputing row 1/400 with 3 missing, elapsed time: 0.226\n",
      "Imputing row 101/400 with 4 missing, elapsed time: 0.229\n",
      "Imputing row 201/400 with 1 missing, elapsed time: 0.234\n",
      "Imputing row 301/400 with 2 missing, elapsed time: 0.237\n"
     ]
    }
   ],
   "source": [
    "from fancyimpute import KNN\n",
    "#Use k=5 nearest rows which have a feature to fill in each row's missing\n",
    "df1 = KNN(k=3).fit_transform(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['age', 'bp', 'sg', 'al', 'su', 'rbc', 'pc', 'pcc', 'ba', 'bgr', 'bu', 'sc', 'sod', 'pot', 'hemo', 'pcv', 'wc', 'rc', 'htn', 'dm', 'cad', 'appet', 'pe', 'ane', 'classification']\n"
     ]
    }
   ],
   "source": [
    "#列出df內的欄位，進行取代#\n",
    "print(df.columns.values.tolist())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "#轉換為dataframe#\n",
    "df_knn = pd.DataFrame(df1)\n",
    "df_knn.columns = ['age', 'bp', 'sg', 'al', 'su', 'rbc', 'pc', \n",
    "               'pcc', 'ba', 'bgr', 'bu', 'sc', 'sod', 'pot', 'hemo',\n",
    "               'pcv', 'wc', 'rc', 'htn', 'dm', 'cad', 'appet', 'pe', \n",
    "               'ane', 'classification']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 方法二 平均值填補"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "#遺漏值填入平均值#\n",
    "from sklearn.model_selection import train_test_split\n",
    "for i in ['age','bp','sg','al','su','bgr','bu','sc','sod','pot','hemo','rc','wc','pcv']:\n",
    "    df[i].fillna(df[i].mean(),inplace=True)\n",
    "df_mean = df.dropna(axis=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4.Logistic 迴歸模型績效"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4-1.KNN 填補"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "GLS accuracy = 98.92857142857143\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/oldgoose/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning:\n",
      "\n",
      "Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "y=df_knn[\"classification\"].values\n",
    "x=df_knn.drop([\"classification\"],axis=1)\n",
    "\n",
    "#Preparing the test and training set\n",
    "from sklearn.model_selection import train_test_split\n",
    "x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=1,test_size=0.3)\n",
    "\n",
    "# 建立模型\n",
    "from sklearn import preprocessing, linear_model\n",
    "logistic_regr = linear_model.LogisticRegression()\n",
    "logistic_regr.fit(x_train, y_train)\n",
    "\n",
    "# 計算準確率\n",
    "classification_predictions = logistic_regr.predict(x_train)\n",
    "accuracy = logistic_regr.score(x_train, y_train)\n",
    "print(\"GLS accuracy =\",logistic_regr.score(x_train, y_train)*100)\n",
    "\n",
    "#Confusion Matrix\n",
    "from sklearn.metrics import confusion_matrix\n",
    "y_pred=logistic_regr.predict(x_test)\n",
    "y_true=y_test\n",
    "cm=confusion_matrix(y_true,y_pred)\n",
    "\n",
    "#Confusion Matrix on Heatmap\n",
    "f,ax=plt.subplots(figsize=(5,5))\n",
    "sns.heatmap(cm,annot=True,linewidths=0.5,linecolor=\"red\",fmt=\".0f\",ax=ax)\n",
    "plt.xlabel(\"y_pred\")\n",
    "plt.ylabel(\"y_true\")\n",
    "plt.title(\" GLS Confusion Matrix\")\n",
    "plt.show()\n",
    "#%%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "score=[] #these variables will be used to show the algorithm name and its successes.\n",
    "algorithms=[] "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4-2.平均值填補"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "GLS accuracy = 100.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/oldgoose/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:433: FutureWarning:\n",
      "\n",
      "Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "y=df_mean[\"classification\"].values\n",
    "x=df_mean.drop([\"classification\"],axis=1)\n",
    "\n",
    "#Preparing the test and training set\n",
    "from sklearn.model_selection import train_test_split\n",
    "x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=1,test_size=0.3)\n",
    "\n",
    "# 建立模型\n",
    "from sklearn import preprocessing, linear_model\n",
    "logistic_regr = linear_model.LogisticRegression()\n",
    "logistic_regr.fit(x_train, y_train)\n",
    "\n",
    "# 計算準確率\n",
    "classification_predictions = logistic_regr.predict(x_train)\n",
    "accuracy = logistic_regr.score(x_train, y_train)\n",
    "print(\"GLS accuracy =\",logistic_regr.score(x_train, y_train)*100)\n",
    "\n",
    "#Confusion Matrix\n",
    "from sklearn.metrics import confusion_matrix\n",
    "y_pred=logistic_regr.predict(x_test)\n",
    "y_true=y_test\n",
    "cm=confusion_matrix(y_true,y_pred)\n",
    "\n",
    "#Confusion Matrix on Heatmap\n",
    "f,ax=plt.subplots(figsize=(5,5))\n",
    "sns.heatmap(cm,annot=True,linewidths=0.5,linecolor=\"red\",fmt=\".0f\",ax=ax)\n",
    "plt.xlabel(\"y_pred\")\n",
    "plt.ylabel(\"y_true\")\n",
    "plt.title(\" GLS Confusion Matrix\")\n",
    "plt.show()\n",
    "#%%"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
